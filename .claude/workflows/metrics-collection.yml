name: metrics-collection
description: Automated data collection and analysis rules

collection-rules:
  delivery-metrics:
    frequency: real-time
    agent: metrics-analyst
    data-points:
      - feature-cycle-time:
          source: workflow-events
          calculation: spec-creation to production-deployment
          aggregation: [avg, p50, p90, p99]
          
      - throughput:
          source: feature-completions
          calculation: features-delivered per time-period
          aggregation: [count, trend]
          
      - lead-time:
          source: requirement-to-delivery
          calculation: initial-request to customer-value
          aggregation: [avg, p50, p90]
          
      - deployment-frequency:
          source: deployment-events
          calculation: deployments per time-period
          aggregation: [count, frequency]
          
      - first-pass-success-rate:
          source: review-outcomes
          calculation: features-without-rework / total-features
          aggregation: [percentage, trend]

  quality-indicators:
    frequency: on-event
    agent: quality-guardian
    data-points:
      - defect-density:
          source: bug-reports
          calculation: bugs per feature
          aggregation: [avg, trend]
          
      - test-coverage:
          source: test-results
          calculation: covered-lines / total-lines
          aggregation: [percentage, by-component]
          
      - security-vulnerabilities:
          source: security-scans
          calculation: vulnerabilities by severity
          aggregation: [count, severity-distribution]
          
      - code-maintainability:
          source: static-analysis
          calculation: complexity-metrics
          aggregation: [index, trend]
          
      - requirements-clarity:
          source: spec-lint-results
          calculation: ears-compliance-score
          aggregation: [percentage, improvement-trend]

  team-performance:
    frequency: daily
    agent: steering-architect
    data-points:
      - agent-collaboration-efficiency:
          source: inter-agent-communications
          calculation: successful-handoffs / total-handoffs
          aggregation: [percentage, bottleneck-analysis]
          
      - context-switching-frequency:
          source: task-transitions
          calculation: context-switches per agent per day
          aggregation: [avg, agent-comparison]
          
      - knowledge-transfer-effectiveness:
          source: documentation-usage
          calculation: docs-accessed / questions-asked
          aggregation: [ratio, knowledge-gaps]
          
      - decision-reversal-rate:
          source: adr-changes
          calculation: reversed-decisions / total-decisions
          aggregation: [percentage, stability-score]

  business-impact:
    frequency: weekly
    agent: metrics-analyst
    data-points:
      - feature-adoption:
          source: user-analytics
          calculation: active-users / target-users
          aggregation: [percentage, adoption-curve]
          
      - user-satisfaction:
          source: feedback-systems
          calculation: satisfaction-ratings
          aggregation: [avg, nps, trend]
          
      - business-value-delivered:
          source: business-metrics
          calculation: roi-per-feature
          aggregation: [value, impact-score]
          
      - customer-success-impact:
          source: support-tickets
          calculation: support-volume-change
          aggregation: [percentage-change, severity-analysis]

data-processing:
  real-time-streaming:
    - workflow-events
    - test-results
    - deployment-status
    - security-alerts
    
  batch-processing:
    - code-analysis
    - documentation-metrics
    - business-impact-analysis
    - trend-calculations
    
  predictive-analytics:
    - delivery-risk-prediction
    - quality-degradation-forecasting
    - capacity-planning
    - technical-debt-projection

storage:
  time-series-db: metrics-data
  document-store: analysis-reports
  graph-db: dependency-tracking
  cache: real-time-dashboards

alerts:
  performance-degradation:
    condition: cycle-time > 2x historical-avg
    recipients: [team-lead, steering-architect]
    
  quality-threshold-breach:
    condition: defect-density > threshold OR test-coverage < 80%
    recipients: [quality-guardian, team]
    
  delivery-risk-high:
    condition: predicted-delay > 20% OR blockers > 3
    recipients: [steering-architect, stakeholders]
    
  security-vulnerability:
    condition: critical-vulnerability-detected
    recipients: [security-team, quality-guardian]

dashboards:
  real-time-operations:
    refresh: 1-minute
    metrics: [current-builds, test-status, deployment-health]
    
  team-performance:
    refresh: 15-minutes
    metrics: [cycle-time, throughput, quality-trends]
    
  business-impact:
    refresh: daily
    metrics: [feature-adoption, user-satisfaction, roi]
    
  executive-summary:
    refresh: weekly
    metrics: [delivery-summary, quality-overview, strategic-metrics]